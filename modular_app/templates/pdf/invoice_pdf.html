<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page { size: A4; margin: 15mm; }
        body { font-family: Arial, sans-serif; font-size: 12px; color: #333; line-height: 1.4; margin: 0; padding: 0; }
        .invoice { width: 100%; margin: 0 auto; }
        h1, h2, h3 { margin: 0; font-weight: bold; }
        .header { width: 100%; border-bottom: 3px solid #4CAF50; padding-bottom: 15px; margin-bottom: 20px; }
        .header table { width: 100%; border: none; }
        .company-info h1 { font-size: 20px; margin-bottom: 8px; color: #333; }
        .company-info p { margin: 3px 0; font-size: 11px; color: #666; }
        .invoice-title { text-align: right; }
        .invoice-title h2 { font-size: 28px; color: #4CAF50; margin-bottom: 8px; }
        .invoice-title p { margin: 3px 0; font-size: 11px; }
        .status-badge { display: inline-block; padding: 4px 10px; border: 1px solid #ccc; font-size: 10px; font-weight: bold; }
        .status-unpaid { background: #fff3cd; color: #856404; }
        .status-paid { background: #d4edda; color: #155724; }
        .info-section { width: 100%; margin-bottom: 20px; }
        .info-section table { width: 100%; border: none; }
        .section-title { font-size: 10px; font-weight: bold; color: #999; margin-bottom: 6px; text-transform: uppercase; }
        .info-box p { margin: 3px 0; font-size: 11px; }
        .info-box strong { font-weight: bold; }
        table.items { width: 100%; border-collapse: collapse; margin: 20px 0; }
        table.items thead { background: #f8f9fa; }
        table.items th { text-align: left; padding: 10px 8px; font-weight: bold; font-size: 11px; color: #333; border-bottom: 2px solid #dee2e6; }
        table.items td { padding: 10px 8px; font-size: 11px; border-bottom: 1px solid #f1f1f1; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }
        .totals { width: 300px; float: right; margin-top: 20px; }
        .totals table { width: 100%; border: none; }
        .totals-row { padding: 8px 0; border-bottom: 1px solid #f1f1f1; font-size: 11px; }
        .grand-total { font-size: 16px; font-weight: bold; color: #4CAF50; border-top: 2px solid #dee2e6; padding-top: 12px; }
        .footer { clear: both; margin-top: 30px; padding-top: 20px; border-top: 2px solid #f1f1f1; }
        .footer table { width: 100%; border: none; }
        .footer-section h4 { font-size: 11px; margin-bottom: 8px; color: #666; }
        .footer-section p { font-size: 10px; color: #999; margin: 3px 0; }
        .signature-line { border-top: 1px solid #333; width: 200px; margin-top: 40px; padding-top: 5px; text-align: center; font-size: 10px; }
    </style>
</head>
<body>
    <div class="invoice">
        <!-- Header -->
        <div class="header">
            <table>
                <tr>
                    <td width="50%" class="company-info">
                        <h1>{{ tenant.company_name }}</h1>
                        {% if tenant.admin_phone %}
                        <p>Phone: {{ tenant.admin_phone }}</p>
                        {% endif %}
                        {% if tenant.admin_email %}
                        <p>Email: {{ tenant.admin_email }}</p>
                        {% endif %}
                    </td>
                    <td width="50%" class="invoice-title">
                        <h2>TAX INVOICE</h2>
                        <p><strong>{{ invoice.invoice_number }}</strong></p>
                        <p>Date: {{ invoice.invoice_date.strftime('%d-%m-%Y') }}</p>
                        {% if invoice.payment_status == 'unpaid' %}
                            <span class="status-badge status-unpaid">UNPAID</span>
                        {% else %}
                            <span class="status-badge status-paid">PAID</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>

        <!-- Bill To & Invoice Details -->
        <div class="info-section">
            <table>
                <tr>
                    <td width="50%" class="info-box">
                        <div class="section-title">Bill To</div>
                        <p><strong>{{ invoice.customer_name }}</strong></p>
                        {% if invoice.customer_phone %}
                        <p>Phone: {{ invoice.customer_phone }}</p>
                        {% endif %}
                        {% if invoice.customer_email %}
                        <p>Email: {{ invoice.customer_email }}</p>
                        {% endif %}
                        {% if invoice.customer_address %}
                        <p>{{ invoice.customer_address }}</p>
                        {% endif %}
                        {% if invoice.customer_state %}
                        <p>State: {{ invoice.customer_state }}</p>
                        {% endif %}
                        {% if invoice.customer_gstin %}
                        <p>GSTIN: {{ invoice.customer_gstin }}</p>
                        {% endif %}
                    </td>
                    <td width="50%" class="info-box" style="text-align: right;">
                        <div class="section-title" style="text-align: right;">Invoice Details</div>
                        {% if invoice.due_date %}
                        <p>Due Date: {{ invoice.due_date.strftime('%d-%m-%Y') }}</p>
                        {% endif %}
                        <p>Status: {{ invoice.status|upper }}</p>
                        <p>Payment: {{ invoice.payment_status|upper }}</p>
                    </td>
                </tr>
            </table>
        </div>

        <!-- Items Table -->
        <table class="items">
            <thead>
                <tr>
                    <th width="5%">#</th>
                    <th width="35%">Item</th>
                    <th width="10%" class="text-center">HSN</th>
                    <th width="12%" class="text-center">Qty</th>
                    <th width="13%" class="text-right">Rate</th>
                    <th width="10%" class="text-right">GST %</th>
                    <th width="15%" class="text-right">Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for item in invoice.items %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>
                        <strong>{{ item.item_name }}</strong>
                        {% if item.description %}
                        <br><span style="color: #999; font-size: 10px;">{{ item.description }}</span>
                        {% endif %}
                    </td>
                    <td class="text-center">{{ item.hsn_code or '-' }}</td>
                    <td class="text-center">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(item.rate) }}</td>
                    <td class="text-right">{{ item.gst_rate }}%</td>
                    <td class="text-right"><strong>Rs {{ '{:,.2f}'.format(item.total_amount) }}</strong></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Totals -->
        <div class="totals">
            <table>
                <tr class="totals-row">
                    <td>Subtotal:</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(invoice.subtotal) }}</td>
                </tr>
                {% if invoice.cgst_amount > 0 %}
                <tr class="totals-row">
                    <td>CGST:</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(invoice.cgst_amount) }}</td>
                </tr>
                <tr class="totals-row">
                    <td>SGST:</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(invoice.sgst_amount) }}</td>
                </tr>
                {% endif %}
                {% if invoice.igst_amount > 0 %}
                <tr class="totals-row">
                    <td>IGST:</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(invoice.igst_amount) }}</td>
                </tr>
                {% endif %}
                {% if invoice.discount_amount > 0 %}
                <tr class="totals-row">
                    <td>Discount:</td>
                    <td class="text-right">-Rs {{ '{:,.2f}'.format(invoice.discount_amount) }}</td>
                </tr>
                {% endif %}
                {% if invoice.round_off != 0 %}
                <tr class="totals-row">
                    <td>Round Off:</td>
                    <td class="text-right">Rs {{ '{:,.2f}'.format(invoice.round_off) }}</td>
                </tr>
                {% endif %}
                <tr class="grand-total">
                    <td><strong>TOTAL:</strong></td>
                    <td class="text-right"><strong>Rs {{ '{:,.2f}'.format(invoice.total_amount) }}</strong></td>
                </tr>
            </table>
        </div>

        <!-- Footer -->
        <div class="footer">
            <table>
                <tr>
                    <td width="50%" class="footer-section">
                        {% if invoice.notes %}
                        <h4>Terms & Conditions</h4>
                        <p>{{ invoice.notes }}</p>
                        {% else %}
                        <h4>Terms & Conditions</h4>
                        <p>Payment is due within 30 days of invoice date.</p>
                        {% endif %}
                    </td>
                    <td width="50%" class="footer-section" style="text-align: right;">
                        <div class="signature-line" style="margin-left: auto;">
                            <p><strong>For {{ tenant.company_name }}</strong></p>
                            <p style="font-size: 9px; color: #999;">Authorized Signatory</p>
                        </div>
                    </td>
                </tr>
            </table>
        </div>

        <!-- Thank you note -->
        <div style="margin-top: 20px; padding: 10px; background: #f8f9fa; text-align: center;">
            <p style="margin: 0; font-size: 11px; color: #666;"><strong>Thank you for your business!</strong></p>
        </div>
    </div>
</body>
</html>

