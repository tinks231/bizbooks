<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Bill - {{ bill.bill_number }}</title>
</head>
<body>
<div class="invoice-container">
    <!-- Header -->
    <div class="invoice-header">
        <div class="company-name">{{ tenant.company_name or 'Company Name' }}</div>
        <div class="company-details">
            {% if bill.vendor_address %}{{ bill.vendor_address }}<br>{% endif %}
            {% if bill.vendor_phone %}Phone: {{ bill.vendor_phone }} | {% endif %}
            {% if bill.vendor_gstin %}GSTIN: {{ bill.vendor_gstin }}{% endif %}
        </div>
    </div>
    
    <div class="invoice-title">PURCHASE BILL</div>
    
    <!-- Info Grid -->
    <div class="info-grid">
        <!-- Vendor Info -->
        <div class="info-box">
            <div class="info-box-title">Vendor Details:</div>
            <div class="info-row">
                <span class="info-label">Name:</span>
                <span>{{ bill.vendor_name }}</span>
            </div>
            {% if bill.vendor_phone %}
            <div class="info-row">
                <span class="info-label">Phone:</span>
                <span>{{ bill.vendor_phone }}</span>
            </div>
            {% endif %}
            {% if bill.vendor_gstin %}
            <div class="info-row">
                <span class="info-label">GSTIN:</span>
                <span>{{ bill.vendor_gstin }}</span>
            </div>
            {% endif %}
            {% if bill.vendor_state %}
            <div class="info-row">
                <span class="info-label">State:</span>
                <span>{{ bill.vendor_state }}</span>
            </div>
            {% endif %}
        </div>
        
        <!-- Bill Info -->
        <div class="info-box">
            <div class="info-box-title">Bill Details:</div>
            <div class="info-row">
                <span class="info-label">Bill No:</span>
                <span>{{ bill.bill_number }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Date:</span>
                <span>{{ bill.bill_date.strftime('%d-%b-%Y') }}</span>
            </div>
            {% if bill.due_date %}
            <div class="info-row">
                <span class="info-label">Due Date:</span>
                <span>{{ bill.due_date.strftime('%d-%b-%Y') }}</span>
            </div>
            {% endif %}
            {% if bill.reference_number %}
            <div class="info-row">
                <span class="info-label">Ref No:</span>
                <span>{{ bill.reference_number }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Items Table -->
    <table class="items-table">
        <thead>
            <tr>
                <th style="width: 5%;">#</th>
                <th style="width: 35%;">Item Description</th>
                <th class="text-center" style="width: 10%;">HSN/SAC</th>
                <th class="text-center" style="width: 10%;">Qty</th>
                <th class="text-right" style="width: 12%;">Rate</th>
                <th class="text-right" style="width: 10%;">Disc</th>
                <th class="text-right" style="width: 8%;">GST</th>
                <th class="text-right" style="width: 10%;">Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for item in bill.items %}
            <tr>
                <td class="text-center">{{ loop.index }}</td>
                <td>{{ item.item_name }}</td>
                <td class="text-center">{{ item.hsn_code or '-' }}</td>
                <td class="text-center">{{ "%.2f"|format(item.quantity) }}</td>
                <td class="text-right">₹{{ "%.2f"|format(item.rate) }}</td>
                <td class="text-right">
                    {% if item.discount_amount > 0 %}
                    ₹{{ "%.2f"|format(item.discount_amount) }}
                    {% if item.discount_percent > 0 %}({{ "%.1f"|format(item.discount_percent) }}%){% endif %}
                    {% else %}
                    -
                    {% endif %}
                </td>
                <td class="text-right">{{ "%.1f"|format(item.gst_rate) }}%</td>
                <td class="text-right">₹{{ "%.2f"|format(item.total) }}</td>
            </tr>
            {% endfor %}
            <tr class="total-row">
                <td colspan="7" class="text-right">Subtotal</td>
                <td class="text-right">₹{{ "%.2f"|format(bill.subtotal_amount) }}</td>
            </tr>
        </tbody>
    </table>
    
    <!-- Summary Grid -->
    <div class="summary-grid">
        <!-- GST Breakdown -->
        <div class="summary-box">
            <div class="info-box-title">Tax Summary:</div>
            <table class="gst-table">
                <thead>
                    <tr>
                        <th>Tax</th>
                        <th>Rate</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% if bill.cgst_amount > 0 %}
                    <tr>
                        <td>CGST</td>
                        <td>-</td>
                        <td>₹{{ "%.2f"|format(bill.cgst_amount) }}</td>
                    </tr>
                    {% endif %}
                    {% if bill.sgst_amount > 0 %}
                    <tr>
                        <td>SGST</td>
                        <td>-</td>
                        <td>₹{{ "%.2f"|format(bill.sgst_amount) }}</td>
                    </tr>
                    {% endif %}
                    {% if bill.igst_amount > 0 %}
                    <tr>
                        <td>IGST</td>
                        <td>-</td>
                        <td>₹{{ "%.2f"|format(bill.igst_amount) }}</td>
                    </tr>
                    {% endif %}
                    <tr>
                        <td colspan="2"><strong>Total Tax</strong></td>
                        <td><strong>₹{{ "%.2f"|format(bill.cgst_amount + bill.sgst_amount + bill.igst_amount) }}</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Amount Summary -->
        <div class="summary-box">
            <div class="amount-summary">
                <div class="amount-row">
                    <span>Subtotal:</span>
                    <span>₹{{ "%.2f"|format(bill.subtotal_amount) }}</span>
                </div>
                {% if bill.discount_amount > 0 %}
                <div class="amount-row">
                    <span>Discount:</span>
                    <span>-₹{{ "%.2f"|format(bill.discount_amount) }}</span>
                </div>
                {% endif %}
                <div class="amount-row">
                    <span>Total Tax:</span>
                    <span>₹{{ "%.2f"|format(bill.cgst_amount + bill.sgst_amount + bill.igst_amount) }}</span>
                </div>
                {% if bill.other_charges > 0 %}
                <div class="amount-row">
                    <span>Other Charges:</span>
                    <span>₹{{ "%.2f"|format(bill.other_charges) }}</span>
                </div>
                {% endif %}
                <div class="amount-row total">
                    <span>Total Amount:</span>
                    <span>₹{{ "%.2f"|format(bill.total_amount) }}</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer Grid -->
    <div class="footer-grid">
        <!-- Notes/Terms -->
        <div class="footer-box">
            {% if bill.notes %}
            <div class="footer-box-title">Notes:</div>
            <div>{{ bill.notes }}</div>
            {% endif %}
            {% if bill.terms_conditions %}
            <div class="footer-box-title" style="margin-top: 2mm;">Terms & Conditions:</div>
            <div>{{ bill.terms_conditions }}</div>
            {% endif %}
        </div>
        
        <!-- Signature -->
        <div class="footer-box">
            <div class="signature-box">
                <div>For {{ tenant.company_name or 'Company Name' }}</div>
                <div class="signature-line">Authorized Signatory</div>
            </div>
        </div>
    </div>
    
    <div class="footer-note">
        This is a computer-generated document. No signature required.<br>
        Generated on {{ now.strftime('%d %b %Y at %I:%M %p') }}
    </div>
</div>

<script>
    // Auto-trigger print dialog
    window.onload = function() {
        // Optional: Uncomment to auto-print
        // window.print();
    };
</script>
</body>
</html>
