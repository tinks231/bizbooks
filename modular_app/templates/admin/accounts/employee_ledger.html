{% extends "base_sidebar.html" %}

{% block title %}{{ employee.name }} - Cash Ledger{% endblock %}

{% block page_title %}üë∑ {{ employee.name }} - Cash Ledger{% endblock %}

{% block header_actions %}
<a href="{{ url_for('accounts.employee_cash_list') }}" class="btn btn-secondary">
    ‚Üê Back to Employee Cash
</a>
{% endblock %}

{% block content %}

<div class="container-fluid" style="padding: 30px;">
    
    <!-- Employee Summary Card -->
    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div>
                <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Employee</div>
                <div style="font-size: 24px; font-weight: 700;">{{ employee.name }}</div>
                {% if employee.phone %}
                <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">üì± {{ employee.phone }}</div>
                {% endif %}
            </div>
            <div>
                <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Cash Received</div>
                <div style="font-size: 24px; font-weight: 700; color: #90EE90;">‚Çπ{{ "{:,.2f}".format(total_received) }}</div>
            </div>
            <div>
                <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Expenses Made</div>
                <div style="font-size: 24px; font-weight: 700; color: #FFB6C1;">‚Çπ{{ "{:,.2f}".format(total_spent) }}</div>
            </div>
            <div>
                <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Current Balance</div>
                <div style="font-size: 32px; font-weight: 700;">‚Çπ{{ "{:,.2f}".format(current_balance) }}</div>
            </div>
        </div>
    </div>
    
    <!-- Transactions Table -->
    <div class="ledger-table" style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow: hidden;">
        {% if transactions %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <tr>
                    <th style="padding: 15px; text-align: left; font-weight: 600; font-size: 13px; text-transform: uppercase;">Date</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; font-size: 13px; text-transform: uppercase;">Type</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; font-size: 13px; text-transform: uppercase;">Particulars</th>
                    <th style="padding: 15px; text-align: right; font-weight: 600; font-size: 13px; text-transform: uppercase;">Received (‚Çπ)</th>
                    <th style="padding: 15px; text-align: right; font-weight: 600; font-size: 13px; text-transform: uppercase;">Spent (‚Çπ)</th>
                    <th style="padding: 15px; text-align: right; font-weight: 600; font-size: 13px; text-transform: uppercase;">Balance (‚Çπ)</th>
                </tr>
            </thead>
            <tbody>
                {% for txn in transactions %}
                <tr style="border-bottom: 1px solid #f0f0f0;">
                    <td style="padding: 15px;">
                        {{ txn[0].strftime('%d %b %Y') }}
                    </td>
                    <td style="padding: 15px;">
                        {% if txn[1] == 'employee_advance' %}
                        <span style="background: #d4edda; color: #155724; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                            üí∞ CASH ADVANCE
                        </span>
                        {% elif txn[1] == 'employee_expense' %}
                        <span style="background: #fff3cd; color: #856404; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                            üí∏ EXPENSE
                        </span>
                        {% elif txn[1] == 'employee_return' %}
                        <span style="background: #d1ecf1; color: #0c5460; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                            ‚Ü©Ô∏è RETURNED
                        </span>
                        {% endif %}
                    </td>
                    <td style="padding: 15px;">
                        {% if txn[5] %}
                        <div style="font-weight: 600; color: #2c3e50;">{{ txn[5] }}</div>
                        {% endif %}
                        {% if txn[6] %}
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">{{ txn[6] }}</div>
                        {% endif %}
                    </td>
                    <td style="padding: 15px; text-align: right;">
                        {% if txn[2] > 0 %}
                        <span style="color: #28a745; font-weight: 600;">{{ "{:,.2f}".format(txn[2]) }}</span>
                        {% else %}-{% endif %}
                    </td>
                    <td style="padding: 15px; text-align: right;">
                        {% if txn[3] > 0 %}
                        <span style="color: #dc3545; font-weight: 600;">{{ "{:,.2f}".format(txn[3]) }}</span>
                        {% else %}-{% endif %}
                    </td>
                    <td style="padding: 15px; text-align: right;">
                        <span style="font-size: 16px; font-weight: 700; {% if txn[4] > 0 %}color: #28a745;{% elif txn[4] < 0 %}color: #dc3545;{% else %}color: #6c757d;{% endif %}">
                            {{ "{:,.2f}".format(txn[4]) }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
                
                <!-- Summary Row -->
                <tr style="background: #f8f9fa; font-weight: 700;">
                    <td colspan="3" style="padding: 15px; text-align: right;">TOTAL:</td>
                    <td style="padding: 15px; text-align: right; color: #28a745;">{{ "{:,.2f}".format(total_received) }}</td>
                    <td style="padding: 15px; text-align: right; color: #dc3545;">{{ "{:,.2f}".format(total_spent) }}</td>
                    <td style="padding: 15px; text-align: right; font-size: 18px;">
                        ‚Çπ{{ "{:,.2f}".format(current_balance) }}
                    </td>
                </tr>
            </tbody>
        </table>
        {% else %}
        <div style="text-align: center; padding: 60px 20px; color: #999;">
            <i class="fas fa-receipt" style="font-size: 64px; margin-bottom: 20px; opacity: 0.3;"></i>
            <h3 style="color: #666;">No transactions found</h3>
            <p>No cash advance or expense records for this employee yet</p>
        </div>
        {% endif %}
    </div>
</div>

<style>
/* Table Hover Effects */
.ledger-table tbody tr {
    transition: background 0.2s ease;
}

.ledger-table tbody tr:hover {
    background: #f8f9ff !important;
}

/* Responsive */
@media (max-width: 768px) {
    .ledger-table {
        overflow-x: auto;
    }
    
    .ledger-table table {
        min-width: 800px;
    }
}
</style>

{% endblock %}

